#include <aoc.h>
using namespace std;

const vector<string> inputTestdata = {
    "....#.....",
    ".........#",
    "..........",
    "..#.......",
    ".......#..",
    "..........",
    ".#..^.....",
    "........#.",
    "#.........",
    "......#..."
};

const vector<string> inputData = {
    ".#..#......................#........#........................................#.............#......#...............#...............",
    ".......#...........#........................#..............#.....#......#..##............#.....#.....................##...........",
    ".#.....#........#.##..#.............#...........#................#............#.#.........#.....................#......#..........",
    "...........#...#.#.................................#.....................#............#.....#.#................#..#...............",
    "..................................................................................#...............................................",
    "..................#....................#.................#.........#..#.................#...........#...................#.........",
    ".......#......#................#.......#............................#.................#.........................#...#........#....",
    "................................#..............................................................#.........#.........#..............",
    ".......................................................#............#......#........#.#...................#............#..........",
    ".....#......#..............................................#..............................................#.......................",
    "......#..........................................................................................#................#...............",
    "............................#..................#............#..#.#..............#..........#......................................",
    "......#..........................#...................#..........#....#.........................#.......................#....#..#..",
    "..................................#..........#....................................................................#........#......",
    "..#.................................#..................................................#......................#...................",
    ".....#............#..................#......#...................................#.#........#.#......#........#....................",
    "........#......................#.....#...#.##................................#......#.............................................",
    "...........#.........#...............................................................................#............................",
    "..................................#...##...............................#.............#.........................................##.",
    "..........................#.#..#......................................#........#..............................#...................",
    "......#...........###..#....#........................................................................................#............",
    "..............#.....................................................................#......##.............#.......................",
    ".................................#...................#.........#..............................................#...........#.......",
    "....................#..#...................................................#................................#........#............",
    "........................................#.#.#..................#....................#.....#.................#.....................",
    ".........................#....#.....#.................##...............................................#.......#...#..............",
    "..#.........................#....................#.........................#..............................#...................#...",
    "..................##....#..#..#.#.................................................................#...............................",
    "..............#........................................................#.............................#......#.....................",
    ".................#...........#........................#......#..........##....................#.................................#.",
    "..........................#.............................................#..#.................................#.........#...#......",
    "..#..................##.....................................................#.....................#.......#.....#.................",
    "....#.........................................#..................#.#.........................#.......................#............",
    "...#.....#.#..............................................................#................#......................#...#........#..",
    ".............................#..#......#.....................................................##...................................",
    "...........#......................#....#.........#........................#......................................................#",
    "............#.............................................#.................................#....#................................",
    "..............................................................#.............#................#.........#.........................#",
    "..........................................#....#........#......................#.....#.............#..............................",
    "..#..#.............#...............................................#.....................................................#........",
    "................................................................................#.............#...................................",
    "...............................................#.......................#................#............#....................#.#.....",
    ".......................#.............................#.#..................#...#....#.................................#...#.....#..",
    ".......................#...........................#.........................................#.........#.........................#",
    "...#.........#.....#..........................................#...................................................................",
    "..........#..#...#...#........................#..........#..........................................#......#.........#............",
    "...............#............................#.#...................##.....................................................#........",
    ".........................................................#....................#........................#.........#....##....#...#.",
    "......................................#.#................................................#........................#...............",
    "..........#.............................................................#..#..#..............................#...#...#.#..........",
    ".........#.....................................................................................#...........#..#......#..........#.",
    "............................#....................#..............#...#.............................................................",
    "...........................................................#........#......................#.................................#....",
    ".........#..................#.........#.......#...............................#................#.............#...........#........",
    "............................#.........#...........................................................................................",
    "................................#...........#.......................................#..........#.#.....#..........................",
    "..........................................#.................................................................................#.....",
    "..............#...............................................#...................................................................",
    "...#....#.....................#..........#..#......................#..............................................................",
    ".......................#..........#.................................................#......#.............#........#....#..........",
    ".........................................................................#.#......................................#...............",
    "..........................................#.......................#...............................................#.........#...#.",
    "............................#.......................................................#...#.........#..#...##........#..............",
    "...........................................................................#..............#..........#.............#..............",
    "#............#..#...#..#........#....................#...........#..#.........................................#..........#........",
    "...........................................................................#......#..^.........#.........#........................",
    "......#............................#.............................................................................................#",
    "......................#.....#.......................................................#........................#..........#.........",
    "................#....#.......#.............................#..............#....................#....#....................#........",
    "......#...................................#..................................................................#....................",
    ".....#..............#.#...........................................................#.................#.........#......#........#...",
    "..#..#..#..#........#...........#...........#....##...........#.....................#.............................................",
    "......................##..........................................................................................................",
    "...........#............#.........................................................#.....#.....#....................#..............",
    "#.............#..........#...............#..#.......................................#..............................#..............",
    "#.......................................#........#....#.......................................................#..#.............#..",
    ".......................#...#.....#..#...........................#...........#.........................#...#...#................#..",
    "#...............................................................#........................................#.....................#..",
    "..#.....................#............................##..........#..................##...#.....................................#..",
    ".......#...................##..........................................#........#.................................................",
    ".........................................................#............................................#...............##..........",
    ".......................#......#..............................................................................................#....",
    "...........#.......................................#.................................#..........#.............#..................#",
    "....#.............#......#............................#........................#...................#......#.....#..........#......",
    ".................................................................#................................#...............................",
    "..........................................................#.......................#...#...........................................",
    ".#............#...........................................#............................#..............................#...#.#.....",
    "..#.................................................#.............................................#.....................#.........",
    ".....#...............#...#.......................#.......................#......................................#...........#.....",
    "...........#...#................................#.............................#........#.........................................#",
    "..............................#.....................#......................#...#................................#.................",
    ".........#.....................................................#...#......................................#................#......",
    ".....#.....................#.................................#...................................................#....#......#....",
    "................#.........#.........................#...........#...#..............................................#..............",
    ".................................#....................................................................#..................#......#.",
    "#..............#......................................................................#.....#.....................................",
    ".............#......#..............##.#............#.#.....................#..........#.......#..........................#........",
    ".......#............#.................#...........................................................#.............................#.",
    "...........................#.......................#..................#....#....................................#.................",
    "....#.....##...........................................#...........#.............#........................#.....#.................",
    "............................#..............................................##..........#..................#.......#...............",
    "#.............................#.............#...............................#..........#...#.....................................#",
    ".............#.......#.....................................#...###......##...............#..#..............#.........#............",
    ".......#......##.....#..................#....................................#............#................#...................#..",
    "..............#......................#............#........#.....................................................#.........#....#.",
    ".............#.......#...............................................##......#...........#...........#............................",
    "#.#....#..............................................................#.........................................#...............#.",
    "...#....#........................#.#.......#.....................#.............................#.#......................#.#.......",
    ".##........................................................#.#...................#.....#.................................#........",
    "............................#.#..................................#....#...........................................................",
    "..................................................#......#...............#...............................#..#..#.......#..........",
    "..........#......................#..........#.........................#...............#..##.....................#.................",
    "...#.......#.........................................................#............#.........#...#................................#",
    "....................#...................................#..........#.....#...#..#........#............#................#..........",
    "...............................#........#.....................................#.....................................#.........#...",
    "....#....................#...................................#.#........................#.........................................",
    ".........#............................#.....................#.............#...........##.........#................................",
    ".............................................##........................................#......#................................#..",
    "...#...............................#.#...#...........#.............................#.............................................#",
    ".............................#...........#................#..................................................#............#.......",
    "................#....................................................................................#..#.#.......................",
    "...#.............#.#..#.......................#.................#...............#..#....#..............#............#......#......",
    "...........#......#............................#.....#..........#.#.................#..........#...........#...............#...#..",
    "....#..................#...........................#.........#............#........#..........#..............................#....",
    "..........#.......#...................#......#.......#.......#....................#.....................................#.........",
    "...#....................................................#......#...#...................#.....................#....................",
    "....................#..#.....#......#...................#............#.......................................#...............#....",
    ".........................#.......#.....#..#.......#...........#......##..............................#.........#..................",
    ".#...........#...#.........#....#...#.......#....#........................#...................#...#..................#............",
    ".........##......#..............................#....................#..#...#..................#............................#....."
};

class GuardGallivant {
public:
    GuardGallivant(const vector<string>& _input)
        : input(_input)
        , lab(_input[0].size(), _input.size())
        , runner(_input[0].size(), _input.size())
    {
        cout << "Size of Input: " << input.size() << "/" << input.size() << endl;

        // Parse data
        for (auto y = 0; y < _input.size(); ++y) {
            for (auto x = 0; x < _input[0].size(); ++x) {
                lab[pair<size_t, size_t>(x, y)] = input[y][x];
                if ('^' == input[y][x])
                    runner.setPosition(pair<long, long>(x, y));
            }
        }

        runner.setMaze(lab);
        runner.setblockedFieldTypes("#");
        runner.setOrientation('N');
        runner.setMarkAsSeen('X');
    }

    long getGuardsRoute()
    {
        int lastMove = runner.move();

        while (-1 != lastMove) {
            switch (lastMove) {
            case 1:
                runner.rotate('R');
                lastMove = 0;
                break;
            case 0:
                lastMove = runner.move();
            default:
                break;
            }
        }

        long GuardsRoute = runner.getSeenFields();
        cout << "GuardsRoute: " << GuardsRoute << endl;
        return GuardsRoute;
    }

    long getResultB()
    {
        long resultB = 0;

        cout << "resultB: " << resultB << endl;
        return resultB;
    }

private:
    const vector<string> input;
    maze lab;
    mazerunner runner;
};

TEST_CASE("Testdata")
{
    GuardGallivant problemData(inputTestdata);
    REQUIRE(41 == problemData.getGuardsRoute());
    REQUIRE(0 == problemData.getResultB());
}

TEST_CASE("GuardGallivant")
{
    GuardGallivant problemData(inputData);
    REQUIRE(5030 == problemData.getGuardsRoute());
    REQUIRE(0 == problemData.getResultB());
}